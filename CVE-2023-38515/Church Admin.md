### CVE-2023-38515 Church Admin CSV upload is vulnerable to SSRF causing data leakage 

- **Application**: Church admin <= 3.6.57

- **Status**: Fixed, CVE-2023-38515

- **Threat Impact**: Sensitive data leakage

- Code: POST parameter `path` is used as parameter of sink function `fopen` directly.

  File: `includes/directory.php`

  ```
  $handle = fopen( $_POST['path'], "r");
  ```

- **POC**:
  1. Listen on 8080 on server side
  1. When upload csv, modify path parameter to `http://localhost:8080`
  1. Receive a request on server side. 
